(defun prior-code (c)
    (if (< (char-code c) 97)
        (- (char-code c) 38)
        (- (char-code c) 96)))

(defun sim-char (s1 s2)
    (if (or (string= s1 "") (string= s2 ""))
        #\0
        (if (find (char s1 0) s2)
            (char s1 0)
            (sim-char (subseq s1 1) s2))))

(defun first-half (s)
    (subseq s 0 (/ (length s) 2)))

(defun second-half (s)
    (subseq s (/ (length s) 2)))

(defun rucksacks (l)
    (if (null l)
        0
        (+ (prior-code (sim-char (first-half (car l)) (second-half (car l)))) (rucksacks (cdr l)))))

(defun badge (s1 s2 s3)
    (if (or (string= s1 "") (string= s2 "") (string= s3 ""))
        #\0
        (if (and (find (char s1 0) s2) (find (char s1 0) s3))
            (char s1 0)
            (badge (subseq s1 1) s2 s3))))

(defun badges (l)
    (if (null l)
        0
        (+ (prior-code (badge (nth 0 l) (nth 1 l) (nth 2 l))) (badges (cdddr l)))))


;;used badgeParse.cpp to parse badges into usable LISP string list
(write (badges '("shzsFcPssFhjFssBzdpRcNHNZrpdJdJVJZ" "fwvMCntfCCbSbSbtDgDNrDtDtJHZVH" "GbCwwbwwnGrLhBzjFFFsWPhL" "PpCqRsqqmmtCwMJC" "LHFrLLHDSNHlfWNhDzmjzzJlJzPJMvPJjQ" "SGSWDNrhZhPDSWDZLgVVRgbRppgpGVnpnn" "GRRjbVjmJZlgMRzzrN" "FpDptHpfHfnpPTvDFTWpFPnPcMfNCClNrzcVcrMMzVsCZlsZ" "TFTQDnvLHPFDtVbLwbjdGjdwwJ" "lhljvvhCjjzhjszzBPmnmGVZMGzG" "FbTcTwbtSFdtcMPnTBPQVnnBZT" "SFMpHDtNDSSbSdwppvgJWjJCJJgWgvlJHH" "wzNCWpzCzJnWWpRRNdJrgHLhjfbLrHrchV" "lBMStmPmmLQDPQZlshrdhgrfrcrrddgHgs" "mvGDGQSvDPBlGMLGCvCWpNvpzRWFwqRw" "stBttBThtDZqPWssPWZp" "gRggwwggCGFSBBvPRpHZZrHdZLZq" "ccFJGCNJmmGQzbTDhnQhBBnB" "HJqMqtZbJMmJTqtLtVMqhpfphNdQfhfzzjhhlHll" "rWSBrnwFwWCvwWCwBgPgCgzjQccQhhgRzcdQzjfcNfzR" "CWBCwCvCvvwssWLMtJJGMdMZJsGV" "nFwSFQwsNrrsssSwCrhrCNnfcCRgJRMJTJcMfRzMCMCRvW" "DdbGdLZLttllWWvTzgzzgR" "ZqGzPdLtDjBjDZGPZVmnhQFwqrFQhVFnss" "sNNpCjttjsJjSpgpWjslCTnqqSVffrnhSfDhmhrhfm" "dBwcGzbPBHbbwZcwJbcTTFDFFFDVrdVmFdnDqf" "HzGcczQPHGwzPzGHRctWlvRgtvJlvNlJvRNj" "cFNCFdvcCHvFBCZcwBfRSpttGhDmCghGShmSRt" "QjLnTTzQVzTTnLMqhDgPhGDDSjGPrgSh" "TTJGnJJlLQdNWZWJNBJZ" "WHBpHcMDZHLDbHLtGCnmRmLNGmRqvsCC" "PzTFzPPTJzrSbGsvnmqfsqfqRz" "dJSQQdVFQgjTrjQPWcWHbBVcZVccZtWp" "JDtnRtJzNzTTNlHc" "rQPJFrLPGMMwrGPFwjFMVLjSTWHdWBTdSWdWZlcWTHlZ" "MGFrCvLLwrwPFVVhvLMGGtnqfsmRJgDnqbRgfbqmfC" "jnTtFjcSSvctJjznzvFmpqqPMqQDRVpRqPzqQzVQ" "bhHBfrWpfHsfGNllRrRCPqDCqPqq" "gsGZZpbWgbwHWGNgfZNjvLSTTjtnTgjSSSSJmL" "RLQNdVNnRQdQHVVLGpspNqvtsqptqpTtsp" "MlRWwbRBBFMFjCTFTTFDvj" "WmlWBmBwwmrndnmLRHRQ" "WnftJWlfnWSHGCjWWWSCFqFGBDqBwMcDmmMmGmqD" "pTNhpTrPhhhRPzbhrppLhThLgqDmwccwqPBmMMqnFBcwwmBB" "ZrhQTpzdjSVVtnvZ" "jgtnJtBjtlTdJBZJVQBngQGDCGWpPGCcPWCbWdWMbcpP" "wHstNNttSHPDmHcMCp" "rrFFSvLLNfsFtNSqrtfrhsNjjVTBVgVvnTBvTQvjTgjVZz" "qhZwlqFqFwlJwrDHqHcDvgcNzv" "RCCTQmjCbQTBtRTbjJRDpBrgDHPPpPDvHccDPc" "VmjVWstQJhlJlGVJ" "GggpGwZmgvgJMvbJFQQDbDFbBbFCQDCW" "rtrLzNLtNSPnNqDSQDcQCWlqBQ" "VtzdRPtztLtVRtZmmMTRwCGZpMwp" "vtvqjsCqtshfjcWFHWGjGFJj" "zGrnzDDMpPcTHcSTVTJP" "DbDwMbZRDrZdBBnMznZMGZDfwtlgQhsqCttClsqvsLfCff" "JLzLtLsrzsQdvrWRwMHwcc" "qPmCTzlPjljjFTZmWwcwwvHMMRWwHvMm" "PFqZnVCqTCNjCzNgQsbGBLzLQQ" "CBnppDHllVpPCBshBHpjDTSmZcSrfwvmJcDDTJfw" "dFRLdLFQzNSTBTSNmBJv" "FzFFzRMBFWtQlPlsjjPVMnhC" "CVCfwnfdVvBdBbTNTT" "LNzsHPNWsDjTZqDHqT" "PtLgQsGQLSzWLstPgGWcgQLSNrpplffrnrNhpVCwlGVlrwMn" "jPPVqPsHffzVnHzvSgMcCJGGMSVCll" "pdbpDpBLNmNNppJgcvgSllGjDSGQ" "hrbBwLpjLhhhNZLhNrhZZLHzfsztFzzsrtHfRFnFfRHf" "tdjBdbmSfdHBdHHmZlWjFrnlWQlqvMFvFn" "pDNDJhLhPVPLLLJphJLwNcwnQTcWWTqTrqMWTZvqMrlvFM" "gpVLhNwpgZJCghCLDNwphgmsBdzHHHmSstmfggzdbR" "TfMpfMBVftLMDBSjWDHgzHbgwLgHHvdzggzs" "QJnZcFFnZRHdHjJvwgdg" "RjjRRnmNmmZNjZqZnQcVffBrWqVTqrtffTSTVV" "fZTdTVcVjrjdBzdTnGtgnnGSHHNFGn" "thMWPtPMslmGnWnNnS" "thvbMvQMRphhLCjrzBjZVdcQfC" "MpmgZFgMGdrFrBCVnJ" "JsbJlTTlvLQbVffRRvBBRVjd" "LWlbhHlJhLTJmmGcMMHNmNgN" "bhvmhPrbhqNqQRRGzQjVvvRL" "wTwBZDBTwwggfnngcDfdsVVFQCdzCzDVRsFdQs" "pngWMcgzMgpZWncnMpWNrbNHrNbmHhltWlbl" "nPndBjLPscWSccBVGnScsSzMdhMppMthdMgpMgrzvhhp" "CCFTFDwqZqCCJmhvpDzztVzDNztp" "qQFJTbRVbmCfwTwfmnnssWBGnLnWlRLSGn" "JRlJDSvLRRCdvmDSvdlbZNVBSWZGNgWsZGNgZBVs" "QrjPMqMnLzzjLjFnNNgBpsgtgGGGVZ" "hrjrFqjqFrQfMHPhQzDvvCLJdwwwmvbJbwDH" "HDGrDDDpNsGQNdZQ" "jpjgtgjSjpjllfZZtZsvNdtshqqq" "cbgMfjclWTJcMwjWJfpfmVPLPBnVBHnmVbnmLBbD" "rPrMZNsNrsvrwqvFFFdgQWNzLJJzRW" "pStppStHmcmHpgVSllVcbVbWWDdLFhdbzdRRFhJFLLRF" "cltCHmCBmtSlgjpllgGvTwPZPMfZvPsCMCwZvC" "FRQQMdlFMDWRFQRQMQQDWdFbSSSVJSBbJSlBVVBnPJnzJL" "rsftPfhsrgwznSzzHSLgJG" "fhNsjrjhvsTTvdjcCRMRMRPcCW" "tRtJttHFrjtDQHHBQMMBgMBSghhZQb" "vqWPLpLvqrmPdmqwvqfmPhNBBBlSnbwbgnlnlhNSZZ" "pGpdfzLLspddmqsqPvfvvPpGTVcJJCDRjHrccRtDjcRDFD" "GJMHCdTMWJRhSTlhhSPllt" "fVvqpfBFrqvqNzzgVDFrpDPmSVtQSlSmhjwltlRtmVhn" "pzpBNDBzfDrsNsDRJJRdCssMLdLZWZ" "hFfvWWvdpCwwcwFhphpcZCMmllHLfmbQlbrQLBJmGgQrQm" "nVSNGjGzzSVNTsjzSJrbSrHBSHlrrmQHJB" "PttTNsTRVnNjNqRnzRzRWCCCcpMCWGPMwwFZvFwW" "DvZbFnDDsqDBwwRQgNBm" "HhWpWWRMWChlChdHLlGlGtQtggSNPSSpgPmNgPJQtw" "CMlWGMhhCVHlLCdHTHdrGHdbzjVqnzcvqqjRjFbbzbFFqR" "ZZgCNqqBmjZsNgZCqJgNBdrLFHbBrWlPdHWFbPnHPW" "TVwTDfzDwSDzmcSTcrzdbllnHPHdFlLzbF" "tvDQwVtVvDVmtRsNMgRpJg" "BBpDCpNJnmnpnDDmDGGmtTzqHcGTvTTjTbGjHLVcLb" "swNNhPwwHzTVwwHw" "rPRlPRhSQmmBDpnNfl" "pbRhffPzcPDmfcNTpVBLpBjMGBGjZLLg" "ssrCsqrszgJjZMqZLQ" "SzCwnsllCrssvdrvwzPmDmPPbFRbSThPTPDD" "QWLfcfczQQpcDTpLPfdZRRvRRVqbFWvZbvtqvv" "NsGGJBhCmNdZVqsbdssZ" "rMwwwBBJMrdzPfQMpzMnLQ" "rdtCQhrCtQQprtTWQCHFjPgGBPdFPgvBqRRPqB" "lsVsSnVSbLmmgBcgTLTFGgvq" "wTTDTszsbzMDppJrJhDQ" "ZlmsGLBVCBBZFCFFHqcHVvQhqVQSSHpH" "dbbTRMrRwwzDfrTbFtMvcptvHFQQpqtc" "gdJTDWgfwDwTwmgmNPnNsgFBlZ" "PWhWhGFzzzrLdHCPccbJQJcHPD" "NRpVTpTgRWVlHJNHMcHQMb" "pSRSpVSZWRSTZjgTRTWnFLdZLrrndhdzZvtvzn" "LgctLgVBVLhlPjqRhBLVcVlhbDDcGnNGfwCrbNDnrGbGCJNw" "HmppHMWWmQmMqZZHWQrDDfDCffJrDGJrCb" "qpWZsZZZMZWTLPhTRgTtThRP" "hfhQfFQWzBfhfTQdmzdLDtDjtvHLjt" "qsgpcqMNRmgpqsCwpCmZDvjwvdddHZHvZDtrrd" "SgmNmqScbTSJbhJQ" "dvMTQvTnZJsrQdbbSvMVZMblDwlflfDGgwwHcfGjPfjjrG" "FqBLpBpFpFzRzqNFmgjGlDRHcwPPGwgcgs" "tLNtWshsLLqWMJhTQVVbhvJd" "bgZLMZgzbbLCcPCbMZbcNMgBqSTqSWVtSzvvTTBTqBvRBW" "FhQpJQnGrlhGlrnTqRtTRJqSwDwtVR" "FqlnnFnqFHnGHHdNZdbZbCNMdPLMPb" "HHFnbftcfnfbbTbTnHTNVZZzJlPQlFrFzVJFZsdr" "mvpGCBgwqCvLCqvMQWWzsQQWlPzwzsrV" "hpGSGgqSvqbHcnhfVfct" "lGVrnHsGcnVHzscrlGjHcrHqqWPlJCPJClTLLqCSPLPdqS" "fRbwbtMQZtMMRFMSqfJTTWCTJPJCmd" "ggdvtvdbVVGnpDGg" "BnBjTcbnvhjjlMnNJJfnDnQDGdNDfP" "qwFqVSWwqLpWFmFVCSqFpDDCJNJRQTRfRDGPfdfDQN" "zwHwWVVWWFSqqwWTLqzzztHMvBhlcghblMlcttMllh" "PFFNPNPmlFllbctNLmcjBstrsVrQHJSSHHSnnB" "fddfDhdwGhTWWTDMwMggssjsjndsBsjsnSrVqSVV" "MCvvTWvRMwCvGPpzCcmbplpCVC" "thTqlPPTNbGNhGdqRRhRrNtFWnDnvvFZDpnFvfQDZtvWvv" "HcMzVcVVcHrgHzcMcmmgfQvFQnMjnWDjfnvjQFfQ" "VSmHJLHBJrTrJTlT" "NjnsHjLLjNRddNdBFBSR" "ftsbqfDcDqsrDtqsfSVBhJVFJgdBRVFS" "wvDqwtDlsDDczjzjHvLzLQQM" "qDwstwDtRfpJfVhBVZBMvnlRvv" "zSFzQHFWdgZBVTZhTzrp" "NHdggjGjWHQFPWHNPPbpJfPDtCwCtqDqJfbt" "pvnbqHvnTvlCCpjsBsMGBGWWPp" "RJSJhJCRVJmJwScrhSJdfwFsBGhZBjhGFFFFGgFPGhZW" "cdRrdmwtfcdSmLtcSCQlvQNqQTlqqvtTlv" "rnSlSrgWjVGpTTRhSffpRd" "HtgHPsNNgNHszPcTBphMdhHhBcTc" "JNNbZPZZsszNmtDbPgsmJlwFvWVnCwrlmWlnjnGvCC" "WrVBVgVGGQCrSTTqvVjDqDjv" "FmwRRwwRQhhLFMjFMzdqSSzS" "RcJtbnnLtQWrGHcfrP" "vpzssjmVjVZWNZzzQwtQwccpQhgtQCct" "qDdfLMnMrrTbBLqTqltlTfbGQnghgRwggGgRnhhccCJJcG" "MtdLfSSSddMftlrjjzsSWVSjFvjNvs" "qTRPpRPzJglzGJzpGRHWHljwDtbwffjtbhjfwNfHmwwf" "SZLVdsvrrdFdBcdZvsBdDCNtbmftNwfNbNhCNvtz" "MLzzddLsQRppRlQGPq" "PDDpdJgtpppGgttgdGdgJFzLjVcvVnnCTrVrRPTLvwnTTC" "ZSbHBsSNlZcsfNnnvRrnVjrHwvCC" "NmSmsfsfhmzcDmctJW" "NbrLfrrLqpqWQHtBzbFttJgcgB" "CmwjPPjjjShPvljwvwwjPBFttBtcHzFJcHTRHJRRmT" "CCljjDGhvPCVdVSCdPvrrNfnnQsGqMpqqMqnFW" "bdPdbcDZlddsZbHjrrgrmZmCZhCGjv" "BffLfLVFVMMBRfwMpfzhFGFhGWvWvrhNvvNj" "RMBpRSnffBJjSbJqdPHsDcbqtl" "BgwGwDDZttDDTNND" "WzNNnFRWFtTFlFsh" "WJjPpPqqzWRbrqnNqvVvgvvdcBwgdrVBZG" "FFbMVMFPvJppgvcvrZMjHlCJWHmHHBlqhCmqChCl" "RGQVdVVLnLsQnQnnqWBlBmDRBDWWlhBD" "SftLzQndGfVgFfjvvM" "npvLlFLTWWqdLnJCmBmmpjQjjmjB" "tfgDwzwVVVVtgtrsJtrbjSPQjQmjNBCNBNhPHDHC" "ggVzVtMRgzMrvJLqFnnRnnRT" "gZFZssWgNZTDwHDWzsFwWDQMMpqqpBPMjFtMPSQFqqqM" "vrmvhdnVvQpftStnMN" "JCdLddhhdJdcCdrrmCGhlgNsWDWDwWsgwHgHLZHW" "vSsSGjSPvjvRSGpFprFbqFpppRfp" "ZdmlndtBZbwrwfpWFn" "JmdHdBBHtgllZldBhJZldLLBjPVQTfvGPNzQQSjjzPgTGNTs" "TjTjBjVrTsLRRrMBsMMgzLqGGqgQHQdCQGgpgd" "nbZcmNnPNcbNftvhlhZpgQgCqdSpgCHCqPFzSH" "WfcNvtmmNmQlvNcbsWWjMwMVMRDVMDJM" "hHHnfZSwHDgHcfclSGSnvrnvBCvWWntvzvzbWWVq" "dTJTmspFTsFdRRLvtvLzvvVqtPVtrb" "VFMNFpRJNTppTpsJVRcMGgfGfgZwghgGfcGh" "lLGvwsMJLCMVnTrCrVdHRd" "tbzqtDNNBpNWBtqzfRrFFnrVTTdrQVSVGp" "tztfzmfzzPDzgWNNBbhGMlJLsvhJJjGJhGmM" "rHrVJQVQVJLggDQQLbTvdCCSTdWLLLbCbS" "pNtnwPthmZGRpmPFtqbMSzqffFSdTvbSzW" "GpvvshwtmwsZDljjssHjVBVj" "SmhJdtJhhzQSrzVhtQbtBRNfnFNSnDNGRfFGGMgR" "lHwqPjqwTjLHCWLvPpvNrNMvnNGNfNGNBffGRN" "lCrPTrwpPZWlqPlqpWWqZjsmJzbzVtVhhdsJcQdddZVJ" "QqpCWHdQdVQlWcQCqcfRjnZZZPDnSPqPhhqZ" "tmmzgWGgwJwwStSZZDRnZssR" "GbFbLLvgmMMwGgmLCrppQrWVlWrFTHHd" "qdqCgSVdVSVqfwsdZhpJspZsph" "RjZBbmRlrlmmJwLNNNhLpwhB" "vZlRrtTZCzCMfSPT" "JBjhCNwjrlJlHJJRsscZrTcvLLgTsLPP" "dDztmntCSgbLgqTzgc" "fGVWnSMFtVGMNNNQllBjWHJC" "dSDhVVdVZtnSgHQGThQvFNQQqF" "LcfLRpMpcBpbrJfsbsscBNWRNPRGHvqPdTGPGqPWFH" "spmrCcrdJJpLLmcmLLLDlzSzCCjVwZVtgnSZzn" "ZJtgPTHtZPZQGbtNzzprVWWVrbrpCD" "BRlfcRmBhSMVBqSVfBvNWrDrjWCjjzprCDCl" "LfMRSmfqfSLcnnMqVSfccnhZwJFHZFTGZQGFLggwZTZGPJ" "BChWddRRRcfmDbfhDP" "MgpMFFsvMfGwvLgPjQPzPPmDcztDtw" "NFgJpqvpLgqFnWWVNSfnNSCR" "zMMMRmMfJpfhpzQJLMVtjtjPntgBtlZlVgJP" "SdNbZvZbvbHTNbZbSWTdrTVBglBDlWBjDPDgntPqBDPt" "rrNcrFwNdSrfzwMzZMLQQs" "JPmCSfHTGJdTCbHgpgqLgRhghhffhg" "ZWSSFVSVFQghQvwpphgh" "lsDtZjVMMSdCNdbGCbjb" "PBQPvDvVVRvQDqLDzJTlzwjz" "tGcZTcdgGcncdrFrsTjzJSJqJqqwHSzzSZwq" "CgtgdFgcFCMnMgsGFGGQWPQpQTCBvbNpNVVWVT" "FHVFWMHMgVhnLWWMpnppfcdZNcPplnfn" "RSvSCBSqGgDRjqCpPlPpppTpPjlcNP" "zRzsGgJDqJwLVWVFwM" "ThhWhNthVWTWqbWbFWbTdBtWSdMlHSlGlCGCdsCMClmnSlMn" "DPPpvvfDHfLgDHvzpvPDsssMsmmzsMcClScMMcGG" "rgPLHHJJHgZfvvZQQZfrpfFqBBwFBTNTBNBwtthQwVqt" "JJgSWDSmSDQCFrhbRLSwLS" "VznqzVNsMsZLdqslbRChtbHdHRrwHb" "LVfNLMsLTmWDpBpf" "cbTsnNpcnnchllFQlMRgJhRP" "WddmdMVSBMWSBWjwCJVCPRwPFCQRRC" "DWSSfjdSrTpDnHHMbZ" "fgsVqqwQQtHhCrDfJH" "pvbnBZWBbvWbTdthrJbDmqrmHq" "TvZSNSNNSvFMBpqpnLnTBZBFGQwlQFggcFzcVGRlswsRll" "zfMcQHzPtRNvlllc" "BLnMhbZMLJLNNVtCdNgZgt" "BJGFpqMBhBLLMqnwBhbrbhLssjFzssjfDzsmFmjmQFQPjT" "JPBJPnpBFrqBJHtjlCjHJcCthM" "wQZggQWQGfZFVmmGfDRjlvvNcvlNDhcNttlctt" "SfmWfwVFwVGZWQVGSTdTbBpTPSqBbLnnrn" "RJqBRJbqpqqJGvqHMmcfczfcjvHQfm" "llgVnSWSlsssTnlWjhTcsZMcZcZMZMcccMNmcH" "TnFhhllnWCnVCTllLnhhVSrbDDPrdpjRRqjBPRBBpbFJ" "mRwRRNDjNTqwDNjNnNRTsQLcQWpQWZJLlLpQWs" "PMFGCSzzgbBVzCGShVQZcgWsQLLftttQtlZZ" "SlGVldCGGbBPMhPCVSBrNNdjRqjDrNmDnmrRwN" "mqGGqGHnqGBCMrnGCbbbLgTTFFNNghHNTj" "SdRfcsDPPcDdRzWPWltSlscwTSbShhgpQhgbFLbTQFjwhN" "DPWWZzzztsDDtfzlscsPdcWZnVMNVqqGJnBrVqCrMrVvZnBJ" "ZgglFCrrrlrWCJswHmwRVmFSwSsP" "zhzqBLcjjnpzMzjhTtcqnVGbwssVRmqbHNPbwPsVNH" "ftBjzLtptRWdvZlQQZQf" "nGpsMncVRMGSnfsBllZdppwrTljZrQ" "gcgHmtbCthHWhwBFBWZBlWlWrd" "bCDDqHhcqbbtqcqtvJMzsGRsvVfPsfnzJV" "TclPvSGZsPZRjhjWDgjp" "JtnwHFtJqtwfQfgWgRWhdhjtgdRM" "JBwnHwgFFqVJrsGmPvNTPsVvSN" "ZJnfZNnDNZJLzNntDtDNNzNWTVBPrrvRRGdBcVRfPPcvfdMr" "CFgjFmggQSQQmSggVMMvRdTvBVRjrdrc" "mbsqQFqFgwwmgmSbwQWWLDWzpLcLnzZzLbLL" "PnwSFSLSTwbbHdtstW" "RrDZVVfJNZCmDCfVDVlblZHbddtHScbWbMjt" "NmzqhzCCqmzffhCCqrhhLLnPvpnTPPgpGTTBSL" "ShhfLSDDFMPQddpMrDgNbjzffqqqzgcjbqZR" "sCstmwJwVBtmTltVmTVbRbcbcRvqvrZvBRvZbR" "VwCnwnVrrrWShWPHHDdQFL" "pbpDpWjZMmFCmmmb" "jTjtJLJgJncCFmnJFC" "LvhvhTQhBSdRNtLNsSszlGrHSGjZDlGf" "JrhvTNJJhhCrtVtcrNLwDBSBwqzDwQVbBLQS" "RnCgHmHHGMdPsGMfDlDqlSQbQnQQDbzD" "RdPMPsmWHmjfMffPcCWrptcprpFTFrFp")))
